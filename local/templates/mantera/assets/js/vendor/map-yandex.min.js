class YandexMap{constructor(e,t){this.selector=e,this.options=t,this.data,this.centerMap=t.centerMap,this.arrayPlaces=[],this.collection={},this.obYmaps={},this.getData(),this.render()}getData=()=>{Array.isArray(this.options.data)?this.data=this.options.data:this.data=Object.values(this.options.data)};render=()=>{if(document.querySelector("#"+this.selector)){const e=this;ymaps.ready(function(){e.obYmaps=new ymaps.Map(e.selector,{center:e.centerMap,zoom:15}),e.getArrayPlaces(),e.createMarksGroup(),e.RenderTabs(),document.querySelector(".tabs-promo__nav-btn:nth-child(1)").click()})}};getArrayPlaces=()=>{this.arrayPlaces=[],this.data.map(e=>{"object"==typeof e.filials&&(e.filials=Object.values(e.filials)),e.filials.map(e=>{this.arrayPlaces.push(e)})})};createMarksGroup(){this.collection=new ymaps.GeoObjectCollection(null),this.obYmaps.geoObjects.removeAll(),this.obYmaps.geoObjects.add(this.collection);for(var e=0;e<this.arrayPlaces.length;e++)this.createMark(this.arrayPlaces[e])}createMark(e){this.placemark=new ymaps.Placemark(e.coord,{iconCaption:e.name,balloonContentBody:`
                    <p class="balloon-text">${e.name}</p>
                    <p class="balloon-text">${e.title}</p>
                    <p class="balloon-text">Скидка: ${e.discount}</p>
                    <p class="balloon-text">Адрес: ${e.address}</p>
                `},{preset:"islands#yellowDotIcon",color:"#ff0000",iconImageSize:[30,37]}),this.collection.add(this.placemark)}createArea=()=>{this.arrayAreas=[],this.data.map(e=>{e.areas.map(e=>(this.arrayAreas.push(e),null))});let e=new ymaps.GeoObjectCollection({},{preset:"islands#redCircleIcon",strokeWidth:4,geodesic:!0});for(var t=0;t<this.arrayAreas.length;t++)this.myGeoObject=new ymaps.GeoObject({geometry:{type:"Polygon",coordinates:this.arrayAreas[t].coord,fillRule:"nonZero"},properties:{balloonContent:"Многоугольник"}},{fillColor:this.arrayAreas[t].fillColor,strokeColor:this.arrayAreas[t].strokeColor,opacity:.5,strokeWidth:3,strokeStyle:"solid"}),e.add(this.myGeoObject);this.obYmaps.geoObjects.add(e)};createPolygon(e){let t=new ymaps.GeoObjectCollection({},{preset:"islands#redCircleIcon",strokeWidth:4,geodesic:!0});for(var a=0;a<e.el.length;a++)this.myGeoObject=new ymaps.GeoObject({geometry:{type:"Polygon",coordinates:e.el[a].coord,fillRule:"nonZero"},properties:{balloonContent:e.name}},{fillColor:e.el[a].fillColor,strokeColor:e.el[a].strokeColor,opacity:.5,strokeWidth:3,strokeStyle:"solid"}),t.add(this.myGeoObject);this.obYmaps.geoObjects.add(t)}createPoint(t){this.collection=new ymaps.GeoObjectCollection(null),this.obYmaps.geoObjects.add(this.collection);for(let e=0;e<t.length;e++)this.placemark=new ymaps.Placemark(t[e].coord,{iconCaption:t[e].name.replace(/&quot;/g,'"'),balloonContentBody:`
                        <p class="balloon-text">${t[e].name}</p>
                        <p class="balloon-text">${t[e].title}</p>
                        <p class="balloon-text">Скидка: ${t[e].discount}</p>
                        <p class="balloon-text">Адрес: ${t[e].address}</p>
                    `},{preset:"islands#yellowDotIcon",color:"#ff0000",iconImageSize:[30,37]}),this.collection.add(this.placemark)}RenderTabs=()=>{const e=document.querySelectorAll(".tabs-promo__nav-btn"),o=this;e.forEach(a=>a.addEventListener("click",function(){"function"==typeof o.obYmaps.geoObjects.removeAll&&o.obYmaps.geoObjects.removeAll();let e=a;var t=e.getAttribute("data-tab-item");this.ArrayTabsId=[],this.ArrayCenter=[],this.ArrayAreas=[],this.ArrayPoints=[],o.data.forEach(e=>(this.ArrayAreas.push({el:e.areas,name:e.polygonName}),this.ArrayPoints.push(e.filials),null)),o.data.map(e=>(this.ArrayTabsId.push(e.tabId),this.ArrayCenter.push(e.center),null));for(let e=0;e<this.ArrayTabsId.length;e++)t==="#tab_"+this.ArrayTabsId[e]&&(o.obYmaps.setCenter(this.ArrayCenter[e]),o.createPolygon(this.ArrayAreas[e]),o.createPoint(this.ArrayPoints[e]))}))}}